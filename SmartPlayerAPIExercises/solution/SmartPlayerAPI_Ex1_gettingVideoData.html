<!DOCTYPE html>
<html>
	<head>
		<title>Player API Exercise 1</title>
		<link rel="stylesheet" type="text/css" href="SmartPlayerAPI.css" />
		<style>
    .BrightcoveExperience {
      float: left;
    }
    fieldset {
      float: right;
    }
    </style>
	</head>
	<body>
		<h1>Smart Player API Getting Video Data Example</h1>
		<p>The buttons below are for development purposes only, to switch between Flash and  HTML5 players. Do not use these in production, as the method is unsupported. You should let the Smart Player decide whether to load Flash or HTML5 instead.</p>
		<div id="modeSwitch">
			<button onclick="switchToHTML5()" style="margin-bottom: 20px;margin-right: 10px;">Switch to HTML5 Player</button>
			<button onclick="switchToFlash()" style="margin-bottom: 20px;">Switch to Flash Player</button>
		</div>
		<!-- Start of Brightcove Player -->
		<script language="JavaScript" type="text/javascript" src="http://admin.brightcove.com/js/BrightcoveExperiences.js"></script>

		<object id="myExperience" class="BrightcoveExperience">
		  <param name="bgcolor" value="#FFFFFF" />
		  <param name="width" value="480" />
		  <param name="height" value="270" />
		  <param name="playerID" value="1146049103001" />
		  <param name="playerKey" value="AQ~~,AAAA1oy1bvE~,ALl2ezBj3WEd1K9zn5lA_OOffNUFbVae" />
		  <param name="isVid" value="true" />
		  <param name="isUI" value="true" />
		  <param name="dynamicStreaming" value="true" />
		  <param name="@videoPlayer" value="928121847001" />
		  <!-- params for Smart Player API -->
		  <param name="includeAPI" value="true" />
		  <param name="templateReadyHandler" value="onTemplateReady" />
		</object>

		<script type="text/javascript">brightcove.createExperiences();</script>

		<!-- End of Brightcove Player -->
		<fieldset id="generatedContent">
			<legend>Generated Content</legend>
			<div id="results"></div>
		</fieldset>
		<!-- include handlebars.js templating system -->
		<script type="text/javascript" src="http://files.brightcove.com/handlebars-1.0.rc.1.js"></script>
		<script type="text/javascript">
			(function(window) {			
  			// markup templates
  			var htmlTemplate = "<p>Tags:</p><ul>{{#tags}}<li>{{.}}</li>{{/tags}}</ul>";
  			// event listener for the player being ready
  			onTemplateReady = function(event) {
  			  log("onTemplateReady");
  			  player = brightcove.api.getExperience("myExperience");
  			  // get a reference to the video player
  			  videoPlayer = player.getModule(brightcove.api.modules.APIModules.VIDEO_PLAYER);
  			  // get the long description for the video and display it
  			  // refactoring tip: if the handler is brief, use an anonymous function for it (as below) - for more complex handlers, you can simply include the function name here and define it elsewhere
  			  videoPlayer.getCurrentVideo( function(videoDTO) {
  		  		log(videoDTO);
            var template = Handlebars.compile(htmlTemplate);
            var data = videoDTO;
            var results = template(data);
  		  		document.getElementById("results").innerHTML = results;
  		  	});
  			}
  			// for development purposes only: reopen page with HTML5 player
  			window.switchToHTML5 = function() {
  				var separator = "?";
  				if (document.location.href.indexOf("?", 0) > -1) {
  					separator = "&";
  				}
  				window.location = document.location.href + separator + "forceHTML=true";
  			};
  			// for development purposes only: switch back to Flash
  			window.switchToFlash = function() {
  				var startOfQuery = document.location.href.indexOf("forceHTML", 0) -1;
  				window.location = document.location.href.substring(0, startOfQuery);
  			};
  			// debugging tool - wraps console.log to avoid errors in IE 7 & 8
  			function log(message) {
  			  if (window["console"] && console["log"]) {
  			    var d = new Date();
  			    console.log(d + ": ");
  			    console.log(message);
  			  }
  			}
      })(window);
		</script>

	</body>
</html>

<!DOCTYPE html>
<html>
	<head>
		<title>Player API Exercise 1</title>
    <link href="http://files.brightcove.com/proxima-nova/font-faces.css" rel="stylesheet" type="text/css">
    <link href="./css/api-samples.css" rel="stylesheet" type="text/css">
	</head>
	<body>
    <div id="main"
		  <!-- id of first section is always "top" -->
		  <div id="top" class="section">
		    <h1><a name="top"></a>Smart Player API Samples: Basic Setup</h1>
		    <p>This example shows the basic setup for working with the Smart Player API, including:</p>
		    <ul>
		      <li>Adding <code>params</code> required in the player publishing code to include the API and specify handlers for initial player events</li>
		      <li>Getting a reference to the BrightcoveExperience object when the player loads</li>
		      <li>Getting references to API modules</li>
		      <li>Calling an API module method and handling the results</li>
		      <li>Adding an event listener and setting up a handler for the event</li>
		      <li>Removing an event listener</li>
		    </ul>
		    <p>For a detailed explanation of this sample, see the <a href="http://docs.brightcove.com/en/smart-player-api/quick-start.html">Getting Started Guide</a>.</p>
		  </div>
		  <!-- every div class section must have an id -->
		  <div class="section" id="resources">
		    <h2><a name="resources"></a>API resources used</h2>
		    <p>This sample uses the following API resources</p>
		    <h4>Modules and methods</h4>
		    <ul>
		      <li>VIDEO_PLAYER
		        <ul>
		          <li>getCurrentVideo()</li>
		          <li>addEventListener()</li>
		          <li>removeEventListener()</li>
		        </ul>
		      </li>
		    </ul>
		    <h4>Events</h4>
		    <ul>
		      <li>templateLoad</li>
		      <li>templateReady</li>
		      <li>Media: PROGRESS</li>
		    </ul>
		  </div>
		  <div class="section" id="player">
		    <!-- h2 contents will be in page navigation label - 21 characters (including spaces) maximum -->
		    <h2><a name="player"></a>The player</h2>
		    <p>A standard Chromeless Video Player is used for this sample.</p>
		    <p class="text-warning">Note that the buttons below are for development purposes only &mdash; do not use in production.</p>
		    <div id="modeSwitch">
		      <span class="button" onclick="BCL.switchToHTML5()" style="margin-bottom: 20px;margin-right: 10px;">Switch to HTML5 Player</span>
		      <span class="button" onclick="BCL.switchToFlash()" style="margin-bottom: 20px;">Switch to Flash Player</span>
		    </div>
		    <div class="player-block">
		      <!-- Start of Brightcove Player -->
		      <script language="JavaScript" type="text/javascript" src="http://admin.brightcove.com/js/BrightcoveExperiences.js"></script>
		      <object id="myExperience921449663001" class="BrightcoveExperience">
		        <param name="bgcolor" value="#FFFFFF" />
		        <param name="width" value="480" />
		        <param name="height" value="270" />
		        <param name="playerID" value="2079935931001" />
		        <param name="playerKey" value="AQ~~,AAAA1oy1bvE~,ALl2ezBj3WE0z3yX6Xw29sdCvkH5GCJv" />
		        <param name="isVid" value="true" />
		        <param name="isUI" value="true" />
		        <param name="dynamicStreaming" value="true" />
		        <param name="@videoPlayer" value="921449663001" />
		        <!-- smart player api params -->
		        <param name="includeAPI" value="true" />
		        <param name="templateLoadHandler" value="BCL.onTemplateLoad" />
		        <param name="templateReadyHandler" value="BCL.onTemplateReady" />
		      </object>
		      <script type="text/javascript">brightcove.createExperiences();</script>
		      <!-- End of Brightcove Player -->
		      <p id="videoName"></p>
		      <p id="progress">Video Progress: <span id="progressBar" style="background-color:#64AAB2;"></span></p>
		    </div>
		  </div>
		</div>
    <script src="http://docs.brightcove.com/en/scripts/handlebars-1.0.rc.2.js"></script>
    <script type="text/javascript">
      /******** Any scripts specific to page samples should go here *********/
      /**** Brightcove Learning namespace ****/
      var BCL = {};
      BCL.progress = document.getElementById("progress");
      /**** template loaded event handler ****/
      BCL.onTemplateLoad = function (experienceID) {
        // get a reference to the player and API Modules and Events
        BCL.player = brightcove.api.getExperience(experienceID);
        BCL.APIModules = brightcove.api.modules.APIModules;
        BCL.adEvent = brightcove.api.events.AdEvent;
        BCL.captionsEvent = brightcove.api.events.CaptionsEvent;
        BCL.contentEvent = brightcove.api.events.ContentEvent;
        BCL.cuePointEvent = brightcove.api.events.CuePointEvent;
        BCL.mediaEvent = brightcove.api.events.MediaEvent;
      };
      /**** template ready event handler ****/
      BCL.onTemplateReady = function (evt) {
        // get references to modules
        BCL.videoPlayer = BCL.player.getModule(BCL.APIModules.VIDEO_PLAYER);
        BCL.videoPlayer.getCurrentVideo( function(videoDTO) {
          BCL.log(videoDTO);
          document.getElementById("videoName").innerHTML = "Currently watching: <strong>" + videoDTO.displayName + "</strong>";
        } );
        BCL.videoPlayer.addEventListener(BCL.mediaEvent.PROGRESS, BCL.onProgress);
        BCL.progressBar = document.getElementById("progressBar");
      };
      /**** progress event handler ****/
      BCL.onProgress = function(evt) {
        if ((evt.duration - evt.position) > .1) {
          BCL.progressBar.innerHTML += "&nbsp;";
        } else {
          BCL.videoPlayer.removeEventListener(BCL.mediaEvent.PROGRESS, BCL.onProgress);
          BCL.progress.innerHTML += " Video complete";
        }
      };
      /*************************
      switch for flash/html
      *************************/
      // for development purposes only: reopen page with HTML5 player
      BCL.switchToHTML5 = function() {
          var separator = "?";
          if (document.location.href.indexOf("?", 0) > -1) {
           separator = "&";
          };
          window.location = document.location.href + separator + "forceHTML=true";
      };
      // for development purposes only: switch back to Flash
      BCL.switchToFlash = function () {
          var startOfQuery = document.location.href.indexOf("forceHTML", 0) -1;
          window.location = document.location.href.substring(0, startOfQuery);
      };
      /*************************
      logging
      *************************/
      BCL.log = function (message) {
        if (window["console"] && console["log"]) {
          var d = new Date();
          console.log(d + ": ");
          console.log(message);
        };
      };
    </script>
	</body>
</html>

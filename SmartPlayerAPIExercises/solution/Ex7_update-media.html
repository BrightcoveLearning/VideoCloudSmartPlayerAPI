<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
    <!-- change title to match the h1 heading -->
    <title>Smart Player API Sample: Update Media</title>
    
    <link href="http://files.brightcove.com/proxima-nova/font-faces.css" rel="stylesheet" type="text/css">
    <link href="./css/api-samples.css" rel="stylesheet" type="text/css">
  </head>
  <body>
      <div id="main">
        <!-- id of first section is always "top" -->
        <div id="top" class="section">
          <h1><a name="top"></a>Smart Player API Sample: Update Media</h1>
          <p>This sample uses the <code>updateMedia()</code> of the CONTENT module to modify properties of the current video in the player. The changes only affect the video DTO on the client, not the video in your Video Cloud media library. Here <code>updateMedia</code> is used to remove the video name that is automatically displayed in the upper right portion of the Chromeless Video Player overlay. The overlay itself cannot be modified through the API (or BEML), so the only way to remove this display is to remove <code>displayName</code> data.</p>
        </div>
        <!-- every div class section must have an id -->
        <div class="section" id="resources">
          <h2><a name="resources"></a>API resources used</h2>
          <p>This sample uses the following API resources</p>
          <h4>Modules and methods</h4>
          <ul>
            <li>
              <ul>
                <li>VIDEO_PLAYER
                  <ul>
                    <li>getCurrentVideo()</li>
                    <li>play()</li>
                  </ul>
                </li>
                <li>CONTENT
                  <ul>
                    <li>updateMedia()</li>
                  </ul>
                </li>
              </ul>
            </li>  
          </ul>
          <h4>Events</h4>
          <ul>
            <li>templateLoad</li>
            <li>templateReady</li>
            <li></li>  
          </ul>
        </div>
        <div class="section" id="player">
          <!-- h2 contents will be in page navigation label - 28 characters (including spaces) maximum -->
          <h2><a name="player"></a>The Player</h2>
          <p>A standard Chromeless Video Player is used for this sample.</p>
          <p class="text-warning">Note that the buttons below are for development purposes only &mdash; do not use in production.</p>
          <div id="modeSwitch">
            <span class="button" onclick="BCL.switchToHTML5()" style="margin-bottom: 20px;margin-right: 10px;">Switch to HTML5 Player</span>
            <span class="button" onclick="BCL.switchToFlash()" style="margin-bottom: 20px;">Switch to Flash Player</span>
          </div>
          <div class="player-block">
            <!-- Start of Brightcove Player -->
            <script language="JavaScript" type="text/javascript" src="http://admin.brightcove.com/js/BrightcoveExperiences.js"></script>
            <object id="myExperience921449663001" class="BrightcoveExperience">
              <param name="bgcolor" value="#FFFFFF" />
              <param name="width" value="480" />
              <param name="height" value="270" />
              <param name="playerID" value="2079935931001" />
              <param name="playerKey" value="AQ~~,AAAA1oy1bvE~,ALl2ezBj3WE0z3yX6Xw29sdCvkH5GCJv" />
              <param name="isVid" value="true" />
              <param name="isUI" value="true" />
              <param name="dynamicStreaming" value="true" />
              <param name="@videoPlayer" value="921449663001" />
              <!-- smart player api params -->
              <param name="includeAPI" value="true" />
              <param name="templateLoadHandler" value="BCL.onTemplateLoad" />
              <param name="templateReadyHandler" value="BCL.onTemplateReady" />
            </object>
            <script type="text/javascript">brightcove.createExperiences();</script>
            <!-- End of Brightcove Player -->
          </div>
        </div>
        <div class="section" id="logic">
          <h2><a name="logic"></a>How it is done</h2>
          <p>All you need to do here is call <code>getCurrentVideo()</code>, and then, in the callback, change properties in the videoDTO and call <code>updateMedia()</code>, passing the editing video DTO.</p>
          <p class="text-warning">Note that <code>updateMedia()</code> only works before playback begins.</p>
        </div>
        
      </div>
    </div>
    <!-- bcl scripts ============================================================ -->
    <script src="http://docs.brightcove.com/en/scripts/jquery-1.8.3.min.js"></script>
    <script src="http://docs.brightcove.com/en/scripts/handlebars-1.0.rc.2.js"></script>
    <script type="text/javascript">
      /******** Any scripts specific to page samples should go here *********/
      /**** Brightcove Learning namespace ****/
      var BCL = {};
      /**** template loaded event handler ****/
      BCL.onTemplateLoad = function (experienceID) {
        // get a reference to the player and API Modules and Events
        BCL.player = brightcove.api.getExperience(experienceID);
        BCL.APIModules = brightcove.api.modules.APIModules;
      };
      /**** template ready event handler ****/
      BCL.onTemplateReady = function (evt) {
        // get references to modules
        BCL.videoPlayer = BCL.player.getModule(BCL.APIModules.VIDEO_PLAYER);
        BCL.contentModule = BCL.player.getModule(BCL.APIModules.CONTENT);
        // get the video DTO
        BCL.videoPlayer.getCurrentVideo( function(videoDTO) {
          // change the display name
          videoDTO.displayName = "";
          // update the video DTO
          BCL.contentModule.updateMedia(videoDTO, function(newVideoDTO) {
            // play the video
            BCL.videoPlayer.play();
          });
        });
      };
      /*************************
      switch for flash/html
      *************************/
      // for development purposes only: reopen page with HTML5 player
      BCL.switchToHTML5 = function() {
          var separator = "?";
          if (document.location.href.indexOf("?", 0) > -1) {
           separator = "&";
          };
          window.location = document.location.href + separator + "forceHTML=true";
      };
      // for development purposes only: switch back to Flash
      BCL.switchToFlash = function () {
          var startOfQuery = document.location.href.indexOf("forceHTML", 0) -1;
          window.location = document.location.href.substring(0, startOfQuery);
      };
      /*************************
      logging 
      *************************/
      BCL.log = function (message) {
        if (window["console"] && console["log"]) {
          var d = new Date();
          console.log(d + ": ");
          console.log(message);
        };
      };
    </script>
  </body>
</html>

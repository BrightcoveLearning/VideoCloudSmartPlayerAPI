<!DOCTYPE html>
<html>
	<head>
		<title>Mulitiple Playlist Exercise 3</title>
				<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<link rel="stylesheet" type="text/css" href="SmartPlayerAPI.css" />
		<style>
		body {
  		width: 1024px;
		}
		.BrightcoveExperience {
		  float: left;
		}
		fieldset {
		  float: right;
		}
		</style>

	</head>
	<body>
		<h2>Smart Player API Updating Media Example</h2>
		<p><em>The buttons below are for development purposes only, to switch between Flash and  HTML5 players. Do not use these in production, as the method is unsupported. You should let the Smart Player decide whether to load Flash or HTML5 instead.</em></p>
		<div id="modeSwitch">
			<button onclick="switchToHTML5()" style="margin-bottom: 20px;margin-right: 10px;">Switch to HTML5 Player</button>
			<button onclick="switchToFlash()" style="margin-bottom: 20px;">Switch to Flash Player</button>
		</div>
								<script language="JavaScript" type="text/javascript" src="http://admin.brightcove.com/js/BrightcoveExperiences.js"></script>

								<object id="myExperience" class="BrightcoveExperience">
								  <param name="bgcolor" value="#FFFFFF" />
								  <param name="width" value="480" />
								  <param name="height" value="270" />
								  <param name="playerID" value="1146049103001" />
								  <param name="playerKey" value="AQ~~,AAAA1oy1bvE~,ALl2ezBj3WEd1K9zn5lA_OOffNUFbVae" />
								  <param name="isVid" value="true" />
								  <param name="isUI" value="true" />
								  <param name="dynamicStreaming" value="true" />
								  <param name="@videoPlayer" value="928121847001" />
								  <!-- params for Smart Player API -->
								  <param name="includeAPI" value="true" />
								  <param name="templateReadyHandler" value="onTemplateReady" />
								</object>

								<script type="text/javascript">brightcove.createExperiences();</script>

								<!-- End of Brightcove Player -->
   <fieldset>
      <legend>Results</legend>
			<div id="results"></div>
    </fieldset><br>
		<!-- include handlebars.js templating system -->
		<script type="text/javascript" src="http://files.brightcove.com/handlebars-1.0.rc.1.js"></script>
		<script type="text/javascript">
			(function(window) {
  			resultsTemplate = "<img src=\"{{videoStillURL}}\"/><br/><p>New Video Still</p>";
  			onTemplateReady = function(event) {
  			  console.log("onTemplateReady");
  			  /***
  			  get references to the player and modules - the argument "myExperience" MUST match the value of the id attribute for the <object> tag in the player publishing code - adjust here or there to make them match
  			  ***/
  			  player = brightcove.api.getExperience("myExperience");
  			  videoPlayer = player.getModule(brightcove.api.modules.APIModules.VIDEO_PLAYER);
  			  contentModule = player.getModule(brightcove.api.modules.APIModules.CONTENT);
  			  // get the current video DTO
  			  videoPlayer.getCurrentVideo( function(videoDTO) {
  			  	var newVideoDTO = videoDTO;
  			  	newVideoDTO.videoStillURL = "http://files.brightcove.com/BCL_alternateStill.png";
  			  	contentModule.updateMedia(newVideoDTO, function(videoDTO){
  			  		console.log(videoDTO);
  			  		var template = Handlebars.compile(resultsTemplate);
  			  		var data = videoDTO;
  			  		var results = template(data);
  			  		document.getElementById("results").innerHTML = results;
  			  		videoPlayer.loadVideoByID(videoDTO.id);
  			  	});
  			  });
  			}
  			// for development purposes only: reopen page with HTML5 player
  			window.switchToHTML5 = function() {
  				var separator = "?";
  				if (document.location.href.indexOf("?", 0) > -1) {
  					separator = "&";
  				}
  				window.location = document.location.href + separator + "forceHTML=true";
  			};
  			// for development purposes only: switch back to Flash
  			window.switchToFlash = function() {
  				var startOfQuery = document.location.href.indexOf("forceHTML", 0) -1;
  				window.location = document.location.href.substring(0, startOfQuery);
  			};
			})(window);
		</script>
	</body>
</html>
